#!/usr/bin/env python
"""
آماده‌سازی نهایی برای ایجاد تور ۳۰ سپتامبر در ادمین
این فایل داده‌های آماده برای کپی در ادمین را فراهم می‌کند
"""
import os
import sys
import django
from datetime import date, time
from decimal import Decimal

# تنظیم Django
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'peykan.settings')
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
django.setup()

from tours.models import TourCategory

def prepare_admin_data():
    """آماده‌سازی داده‌ها برای ادمین"""

    print("🎯 آماده‌سازی داده‌های تور ۳۰ سپتامبر برای ادمین")
    print("="*60)

    # اطمینان از وجود دسته‌بندی
    category, created = TourCategory.objects.get_or_create(
        slug='cultural-tours',
        defaults={'name': 'تورهای فرهنگی'}
    )

    print("\\n📋 داده‌های آماده برای کپی در ادمین تور:")
    print("="*50)

    admin_data = {
        "اطلاعات پایه": {
            "Slug": "tour-30-sep-2025",
            "عنوان (فارسی)": "تور فرهنگی ۳۰ سپتامبر ۲۰۲۵",
            "توضیحات (فارسی)": "تور کامل فرهنگی یک روزه با سه واریانت مختلف شامل ECO، NORMAL و VIP. پیمایش جاذبه‌های فرهنگی تهران با راهنمای متخصص.",
            "توضیحات کوتاه": "تور فرهنگی یک روزه ۳۰ سپتامبر"
        },

        "دسته‌بندی و نوع": {
            "دسته‌بندی": "Cultural Tours",
            "نوع تور": "Day tour",
            "نوع حمل و نقل": "Land"
        },

        "مکان": {
            "شهر": "تهران",
            "کشور": "ایران"
        },

        "قیمت‌گذاری": {
            "قیمت پایه (دلار)": "100.00",
            "واحد پول": "USD"
        },

        "زمان‌بندی": {
            "مدت زمان (ساعت)": "8",
            "زمان تحویل": "08:30:00",
            "زمان شروع": "09:00:00",
            "زمان پایان": "17:00:00"
        },

        "ظرفیت و رزرو": {
            "حداقل شرکت‌کنندگان": "2",
            "حداکثر شرکت‌کنندگان": "30",
            "مهلت کنسلی (ساعت)": "24"
        },

        "سیاست کنسلی": {
            "ساعت‌های کنسلی": "48",
            "درصد بازپرداخت": "80"
        },

        "خدمات شامل": {
            "شامل انتقال": "✅ True",
            "شامل راهنما": "✅ True",
            "شامل غذا": "✅ True",
            "شامل عکاس": "❌ False"
        },

        "محتوا": {
            "نکات برجسته": "بازدید از کاخ گلستان، مسجد امام، بازار سنتی تهران، موزه هنرهای معاصر",
            "قوانین و مقررات": "• حضور دقیق در زمان تعیین شده\\n• رعایت حجاب اسلامی\\n• همراه داشتن کارت شناسایی\\n• ممنوعیت دخانیات",
            "وسایل مورد نیاز": "• کفش راحت پیاده‌روی\\n• دوربین عکاسی\\n• بطری آب\\n• کرم ضد آفتاب\\n• کلاه آفتابی"
        },

        "وضعیت": {
            "ویژه": "✅ True",
            "محبوب": "❌ False",
            "فعال": "✅ True"
        }
    }

    for section, data in admin_data.items():
        print(f"\\n🏷️ {section}:")
        print("-" * 30)
        for key, value in data.items():
            print(f"   • {key}: {value}")

    print("\\n" + "="*60)
    print("📋 دستورالعمل گام به گام ایجاد تور در ادمین:")
    print("="*60)

    steps = [
        ("۱. ورود به ادمین", "http://127.0.0.1:8000/admin/"),
        ("۲. انتخاب Tours > Tours", "روی 'Tours' کلیک کنید"),
        ("۳. افزودن تور جدید", "روی 'Add Tour' کلیک کنید"),
        ("۴. پر کردن فیلدها", "داده‌های بالا را کپی کنید"),
        ("۵. ذخیره تور پایه", "روی 'Save' کلیک کنید"),
        ("۶. ایجاد واریانت‌ها", "Tour Variants > Add Tour Variant"),
        ("۷. ایجاد برنامه زمانی", "Tour Schedules > Add Tour Schedule"),
        ("۸. تنظیم قیمت‌گذاری", "Tour Pricings > Add Tour Pricing"),
        ("۹. اضافه کردن گزینه‌ها", "Tour Options > Add Tour Option")
    ]

    for step, instruction in steps:
        print(f"   {step}: {instruction}")

    print("\\n" + "="*60)
    print("🏷️ تنظیمات واریانت‌ها برای تور ۳۰ سپتامبر:")
    print("="*60)

    variants_config = [
        {
            "نام": "ECO",
            "قیمت پایه": "$80.00",
            "ظرفیت": "10",
            "توضیحات": "واریانت اقتصادی با خدمات پایه",
            "خدمات": ["انتقال", "راهنما", "وعده غذایی"]
        },
        {
            "نام": "NORMAL",
            "قیمت پایه": "$100.00",
            "ظرفیت": "10",
            "توضیحات": "واریانت استاندارد با خدمات کامل",
            "خدمات": ["انتقال", "راهنما", "وعده غذایی", "راهنمای خبره"]
        },
        {
            "نام": "VIP",
            "قیمت پایه": "$150.00",
            "ظرفیت": "10",
            "توضیحات": "واریانت VIP با خدمات ویژه",
            "خدمات": ["انتقال", "راهنما", "وعده غذایی", "عکاس", "انتقال خصوصی", "راهنمای خبره", "وعده ویژه"]
        }
    ]

    for variant in variants_config:
        print(f"\\n🏷️ واریانت {variant['نام']}:")
        print(f"   💰 قیمت پایه: {variant['قیمت پایه']}")
        print(f"   👥 ظرفیت: {variant['ظرفیت']} نفر")
        print(f"   📝 توضیحات: {variant['توضیحات']}")
        print(f"   🎯 خدمات: {', '.join(variant['خدمات'])}")

        # تنظیمات قیمت‌گذاری گروه سنی
        print("   💵 قیمت‌گذاری گروه سنی:")
        base_price = float(variant['قیمت پایه'].replace('$', ''))
        prices = {
            "بزرگسال (۱۰۰%)": f"${base_price:.2f}",
            "کودک (۷۰%)": f"${base_price * 0.7:.2f}",
            "نوزاد (۰%)": "$0.00"
        }
        for age_group, price in prices.items():
            print(f"      • {age_group}: {price}")

    print("\\n" + "="*60)
    print("📅 تنظیمات برنامه زمانی:")
    print("="*60)

    schedule_config = {
        "تاریخ": "۳۰ سپتامبر ۲۰۲۵",
        "زمان شروع": "۹:۰۰ صبح",
        "زمان پایان": "۵:۰۰ عصر",
        "مدت": "۸ ساعت",
        "روز هفته": "سه‌شنبه",
        "قیمت پایه": "$۱۰۰ (برای بزرگسالان)",
        "کل ظرفیت": "۳۰ نفر",
        "توضیحات": "برنامه زمانی برای تور فرهنگی یک روزه"
    }

    for key, value in schedule_config.items():
        print(f"   • {key}: {value}")

    print("\\n" + "="*60)
    print("🎯 تنظیمات گزینه‌های اضافی:")
    print("="*60)

    options_config = [
        {
            "نام": "صبحانه ویژه",
            "قیمت": "$15.00",
            "نوع": "غذا",
            "حداکثر تعداد": "۳۰",
            "توضیحات": "صبحانه ویژه در هتل پنج ستاره"
        },
        {
            "نام": "راهنمای خصوصی",
            "قیمت": "$50.00",
            "نوع": "خدمات",
            "حداکثر تعداد": "۱",
            "توضیحات": "راهنمای اختصاصی برای گروه شما"
        },
        {
            "نام": "پکیج عکس حرفه‌ای",
            "قیمت": "$30.00",
            "نوع": "تجهیزات",
            "حداکثر تعداد": "۱۰",
            "توضیحات": "عکس‌برداری حرفه‌ای در طول تور"
        }
    ]

    for option in options_config:
        print(f"\\n🎯 گزینه {option['نام']}:")
        for key, value in option.items():
            if key != 'نام':
                print(f"   • {key}: {value}")

    print("\\n" + "="*60)
    print("✅ چک لیست نهایی:")
    print("="*60)

    checklist = [
        ("✅", "دسته‌بندی فرهنگی موجود باشد"),
        ("✅", "تصویر اصلی تور آماده باشد"),
        ("✅", "اطلاعات قیمت‌گذاری مشخص باشد"),
        ("✅", "ظرفیت‌ها منطقی باشند (۱۰+۱۰+۱۰=۳۰)"),
        ("✅", "زمان‌ها منطقی باشند"),
        ("✅", "Slug منحصر به فرد باشد"),
        ("🔄", "تور پایه ایجاد شود"),
        ("🔄", "واریانت‌ها اضافه شوند"),
        ("🔄", "برنامه زمانی تنظیم شود"),
        ("🔄", "قیمت‌گذاری انجام شود"),
        ("🔄", "گزینه‌ها اضافه شوند"),
        ("🔄", "برنامه سفر ایجاد شود"),
        ("🔄", "تصاویر اضافه شوند"),
        ("✅", "سیستم تست شود")
    ]

    for status, item in checklist:
        print(f"   {status} {item}")

    print("\\n" + "="*60)
    print("🎉 نتیجه:")
    print("="*60)
    print("✅ تور ۳۰ سپتامبر آماده ایجاد در ادمین است")
    print("✅ همه داده‌ها و تنظیمات مشخص شده‌اند")
    print("✅ سیستم ظرفیت هوشمند کار خواهد کرد")
    print("✅ کاربران می‌توانند تور را رزرو کنند")
    print("="*60)

def show_admin_urls():
    """نمایش URLهای ادمین"""

    print("\\n🔗 URLهای مهم ادمین:")
    print("="*30)

    urls = [
        ("صفحه اصلی ادمین", "http://127.0.0.1:8000/admin/"),
        ("لیست تورها", "http://127.0.0.1:8000/admin/tours/tour/"),
        ("افزودن تور جدید", "http://127.0.0.1:8000/admin/tours/tour/add/"),
        ("واریانت‌ها", "http://127.0.0.1:8000/admin/tours/tourvariant/"),
        ("برنامه زمانی", "http://127.0.0.1:8000/admin/tours/tourschedule/"),
        ("قیمت‌گذاری", "http://127.0.0.1:8000/admin/tours/tourpricing/"),
        ("گزینه‌ها", "http://127.0.0.1:8000/admin/tours/touroption/"),
        ("برنامه سفر", "http://127.0.0.1:8000/admin/tours/touritinerary/"),
        ("گالری تصاویر", "http://127.0.0.1:8000/admin/tours/tourgallery/")
    ]

    for name, url in urls:
        print(f"   • {name}: {url}")

if __name__ == '__main__':
    prepare_admin_data()
    show_admin_urls()
